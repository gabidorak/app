/*! Wiki.js - wiki.js.org - Licensed under AGPL */
(this.webpackJsonp=this.webpackJsonp||[]).push([["editor-code"],{"./client/components/editor/editor-code.vue":function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"editor-code"},[o("div",{staticClass:"editor-code-main"},[o("div",{staticClass:"editor-code-sidebar"},[o("v-tooltip",{attrs:{right:"",color:"teal"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[o("v-btn",e._g({staticClass:"animated fadeInLeft mx-0",attrs:{icon:"",tile:"",dark:"",disabled:""}},s),[o("v-icon",[e._v("mdi-link-plus")])],1)]}}])},[o("span",[e._v(e._s(e.$t("editor:markup.insertLink")))])]),o("v-tooltip",{attrs:{right:"",color:"teal"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[o("v-btn",e._g({staticClass:"mt-3 animated fadeInLeft wait-p1s mx-0",attrs:{icon:"",tile:"",dark:""},on:{click:function(t){return e.toggleModal("editorModalMedia")}}},s),[o("v-icon",{attrs:{color:"editorModalMedia"===e.activeModal?"teal":""}},[e._v("mdi-folder-multiple-image")])],1)]}}])},[o("span",[e._v(e._s(e.$t("editor:markup.insertAssets")))])]),o("v-tooltip",{attrs:{right:"",color:"teal"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[o("v-btn",e._g({staticClass:"mt-3 animated fadeInLeft wait-p2s mx-0",attrs:{icon:"",tile:"",dark:"",disabled:""},on:{click:function(t){return e.toggleModal("editorModalBlocks")}}},s),[o("v-icon",{attrs:{color:"editorModalBlocks"===e.activeModal?"teal":""}},[e._v("mdi-view-dashboard-outline")])],1)]}}])},[o("span",[e._v(e._s(e.$t("editor:markup.insertBlock")))])]),o("v-tooltip",{attrs:{right:"",color:"teal"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[o("v-btn",e._g({staticClass:"mt-3 animated fadeInLeft wait-p3s mx-0",attrs:{icon:"",tile:"",dark:"",disabled:""}},s),[o("v-icon",[e._v("mdi-code-braces")])],1)]}}])},[o("span",[e._v(e._s(e.$t("editor:markup.insertCodeBlock")))])]),o("v-tooltip",{attrs:{right:"",color:"teal"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[o("v-btn",e._g({staticClass:"mt-3 animated fadeInLeft wait-p4s mx-0",attrs:{icon:"",tile:"",dark:"",disabled:""}},s),[o("v-icon",[e._v("mdi-library-video")])],1)]}}])},[o("span",[e._v(e._s(e.$t("editor:markup.insertVideoAudio")))])]),o("v-tooltip",{attrs:{right:"",color:"teal"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[o("v-btn",e._g({staticClass:"mt-3 animated fadeInLeft wait-p5s mx-0",attrs:{icon:"",tile:"",dark:"",disabled:""}},s),[o("v-icon",[e._v("mdi-chart-multiline")])],1)]}}])},[o("span",[e._v(e._s(e.$t("editor:markup.insertDiagram")))])]),o("v-tooltip",{attrs:{right:"",color:"teal"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[o("v-btn",e._g({staticClass:"mt-3 animated fadeInLeft wait-p6s mx-0",attrs:{icon:"",tile:"",dark:"",disabled:""}},s),[o("v-icon",[e._v("mdi-function-variant")])],1)]}}])},[o("span",[e._v(e._s(e.$t("editor:markup.insertMathExpression")))])]),e.$vuetify.breakpoint.mdAndUp?[o("v-spacer"),o("v-tooltip",{attrs:{right:"",color:"teal"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[o("v-btn",e._g({staticClass:"mt-3 animated fadeInLeft wait-p8s mx-0",attrs:{icon:"",tile:"",dark:""},on:{click:e.toggleFullscreen}},s),[o("v-icon",[e._v("mdi-arrow-expand-all")])],1)]}}],null,!1,3552248366)},[o("span",[e._v(e._s(e.$t("editor:markup.distractionFreeMode")))])])]:e._e()],2),o("div",{staticClass:"editor-code-editor"},[o("textarea",{ref:"cm"})])]),o("v-system-bar",{staticClass:"editor-code-sysbar",attrs:{dark:"",status:"",color:"grey darken-3"}},[o("div",{staticClass:"caption editor-code-sysbar-locale"},[e._v(e._s(e.locale.toUpperCase()))]),o("div",{staticClass:"caption px-3"},[e._v("/"+e._s(e.path))]),e.$vuetify.breakpoint.mdAndUp?[o("v-spacer"),o("div",{staticClass:"caption"},[e._v("Code")]),o("v-spacer"),o("div",{staticClass:"caption"},[e._v("Ln "+e._s(e.cursorPos.line+1)+", Col "+e._s(e.cursorPos.ch+1))])]:e._e()],2)],1)};s._withStripped=!0;var i=o("./node_modules/lodash/last.js"),n=o.n(i),d=o("./node_modules/lodash/startsWith.js"),a=o.n(d),l=o("./node_modules/lodash/times.js"),r=o.n(l),c=o("./node_modules/lodash/flatten.js"),u=o.n(c),m=o("./node_modules/vuex-pathify/dist/vuex-pathify.js"),p=o("./node_modules/codemirror/lib/codemirror.js"),v=o.n(p),h=(o("./node_modules/codemirror/lib/codemirror.css"),o("./node_modules/codemirror/mode/htmlmixed/htmlmixed.js"),o("./node_modules/codemirror/addon/selection/active-line.js"),o("./node_modules/codemirror/addon/display/fullscreen.js"),o("./node_modules/codemirror/addon/display/fullscreen.css"),o("./node_modules/codemirror/addon/selection/mark-selection.js"),o("./node_modules/codemirror/addon/search/searchcursor.js"),{data:()=>({cm:null,cursorPos:{ch:0,line:1}}),computed:{isMobile(){return this.$vuetify.breakpoint.smAndDown},locale:Object(m.get)("page/locale"),path:Object(m.get)("page/path"),mode:Object(m.get)("editor/mode"),activeModal:Object(m.sync)("editor/activeModal")},methods:{toggleModal(e){this.activeModal=this.activeModal===e?"":e,this.helpShown=!1},closeAllModal(){this.activeModal="",this.helpShown=!1},insertAtCursor({content:e}){const t=this.cm.doc.getCursor("head");this.cm.doc.replaceRange(e,t)},insertAfter({content:e,newLine:t}){const o=this.cm.doc.getCursor("to").line,s=this.cm.doc.getLine(o).length;this.cm.doc.replaceRange(t?"\n".concat(e,"\n"):e,{line:o,ch:s+1})},insertBeforeEachLine({content:e,after:t}){let o=[];if(this.cm.doc.somethingSelected()?o=u()(this.cm.doc.listSelections().map(e=>{const t=Math.abs(e.anchor.line-e.head.line)+1,o=e.anchor.line>e.head.line?e.head.line:e.anchor.line;return r()(t,e=>e+o)})):o.push(this.cm.doc.getCursor("head").line),o.forEach(t=>{let o=this.cm.doc.getLine(t);const s=o.length;a()(o,e)&&(o=o.substring(e.length)),this.cm.doc.replaceRange(e+o,{line:t,ch:0},{line:t,ch:s})}),t){const e=n()(o);this.cm.doc.replaceRange("\n".concat(t,"\n"),{line:e,ch:this.cm.doc.getLine(e).length+1})}},positionSync(e){this.cursorPos=e.getCursor("head")},toggleFullscreen(){this.cm.setOption("fullScreen",!0)},refresh(){this.$nextTick(()=>{this.cm.refresh()})}},mounted(){this.$store.set("editor/editorKey","code"),"create"===this.mode&&this.$store.set("editor/content","<h1>Title</h1>\n\n<p>Some text here</p>"),this.cm=v.a.fromTextArea(this.$refs.cm,{tabSize:2,mode:"text/html",theme:"wikijs-dark",lineNumbers:!0,lineWrapping:!0,line:!0,styleActiveLine:!0,highlightSelectionMatches:{annotateScrollbar:!0},viewportMargin:50,inputStyle:"contenteditable",allowDropFileTypes:["image/jpg","image/png","image/svg","image/jpeg","image/gif"]}),this.cm.setValue(this.$store.get("editor/content")),this.cm.on("change",e=>{this.$store.set("editor/content",e.getValue())}),this.$vuetify.breakpoint.mdAndUp?this.cm.setSize(null,"calc(100vh - 64px - 24px)"):this.cm.setSize(null,"calc(100vh - 56px - 16px)");const e={F11(e){e.setOption("fullScreen",!e.getOption("fullScreen"))},Esc(e){e.getOption("fullScreen")&&e.setOption("fullScreen",!1)}};this.cm.setOption("extraKeys",e),this.cm.on("cursorActivity",e=>{this.positionSync(e)}),this.$root.$on("editorInsert",e=>{switch(e.kind){case"IMAGE":let t='<img src="'.concat(e.path,'" alt="').concat(e.text,'"');e.align&&""!==e.align&&(t+=' class="align-'.concat(e.align,'"')),t+=" />",this.insertAtCursor({content:t});break;case"BINARY":this.insertAtCursor({content:'<a href="'.concat(e.path,'" title="').concat(e.text,'">').concat(e.text,"</a>")})}}),this.$root.$on("saveConflict",()=>{this.toggleModal("editorModalConflict")}),this.$root.$on("overwriteEditorContent",()=>{this.cm.setValue(this.$store.get("editor/content"))})},beforeDestroy(){this.$root.$off("editorInsert")}}),_=(o("./client/components/editor/editor-code.vue?vue&type=style&index=0&lang=scss&"),o("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),g=o("./node_modules/vuetify-loader/lib/runtime/installComponents.js"),f=o.n(g),j=o("./node_modules/vuetify/lib/components/VBtn/VBtn.js"),b=o("./node_modules/vuetify/lib/components/VIcon/VIcon.js"),y=o("./node_modules/vuetify/lib/components/VGrid/VSpacer.js"),x=o("./node_modules/vuetify/lib/components/VSystemBar/VSystemBar.js"),k=o("./node_modules/vuetify/lib/components/VTooltip/VTooltip.js"),S=Object(_.a)(h,s,[],!1,null,null,null);f()(S,{VBtn:j.a,VIcon:b.a,VSpacer:y.a,VSystemBar:x.a,VTooltip:k.a}),S.options.__file="client/components/editor/editor-code.vue";t.default=S.exports},"./client/components/editor/editor-code.vue?vue&type=style&index=0&lang=scss&":function(e,t,o){"use strict";var s=o("./node_modules/cache-loader/dist/cjs.js?!./node_modules/style-loader/dist/cjs.js!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./node_modules/sass-resources-loader/lib/loader.js?!./node_modules/vuetify-loader/lib/loader.js?!./node_modules/vue-loader/lib/index.js?!./client/components/editor/editor-code.vue?vue&type=style&index=0&lang=scss&");o.n(s).a},"./node_modules/cache-loader/dist/cjs.js?!./node_modules/style-loader/dist/cjs.js!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./node_modules/sass-resources-loader/lib/loader.js?!./node_modules/vuetify-loader/lib/loader.js?!./node_modules/vue-loader/lib/index.js?!./client/components/editor/editor-code.vue?vue&type=style&index=0&lang=scss&":function(e,t,o){var s=o("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),i=o("./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./node_modules/sass-resources-loader/lib/loader.js?!./node_modules/vuetify-loader/lib/loader.js?!./node_modules/vue-loader/lib/index.js?!./client/components/editor/editor-code.vue?vue&type=style&index=0&lang=scss&");"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var n={insert:"head",singleton:!1};s(i,n);e.exports=i.locals||{}},"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/dist/cjs.js?!./node_modules/sass-resources-loader/lib/loader.js?!./node_modules/vuetify-loader/lib/loader.js?!./node_modules/vue-loader/lib/index.js?!./client/components/editor/editor-code.vue?vue&type=style&index=0&lang=scss&":function(e,t,o){}}]);